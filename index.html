<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Merchant Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root { --grab-green: #00B14F; --grab-yellow: #FFD200; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; min-height: 100vh; background-color: var(--grab-green); color: #000; display: flex; flex-direction: column; }
        
        .glass-card { background: white; border: 3px solid #000; box-shadow: 10px 10px 0px #000; border-radius: 4px; }
        .nav-bar { background: white; border-bottom: 4px solid #000; }

        /* Floating Indicator Scheme Menu */
        #strategyContainer { position: relative; }
        #activePointer {
            position: absolute; left: -5px; width: calc(100% + 10px); background: var(--grab-yellow);
            border: 3px solid #000; border-radius: 14px; z-index: 0;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            box-shadow: -6px 0px 0px #000;
        }
        .strat-item { position: relative; z-index: 1; margin-bottom: 8px; }
        .strat-btn { 
            background: transparent; padding: 14px; border: 3px solid #000; border-radius: 14px;
            font-size: 12px; font-weight: 900; text-align: justify; transition: all 0.3s ease; 
            width: 100%; text-transform: uppercase; color: #000;
        }
        .strat-item.active .strat-btn { border-color: transparent; }
        .strat-item:not(.active) .strat-btn { background: #f8fafc; opacity: 0.5; }

        /* Snappy Tier Buttons */
        .tier-btn { 
            border: 2.5px solid #000; padding: 10px; border-radius: 12px; font-size: 10px; font-weight: 900; 
            background: white; flex: 1; transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .tier-btn:active { transform: scale(0.95); }
        .tier-btn.active { 
            background: #000 !important; color: #FFF !important; 
            transform: scale(1.05); box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        /* Input Styling */
        .input-box { border: 3px solid #000; border-radius: 18px; padding: 12px 18px; font-size: 1.4rem; font-weight: 900; background: white; width: 100%; }
        .label-micro { font-size: 10px; font-weight: 900; text-transform: uppercase; letter-spacing: 0.05em; opacity: 0.8; margin-bottom: 5px; display: block; }
        
        .benefit-item { display: flex; align-items: center; gap: 8px; font-size: 11px; font-weight: 800; color: #059669; animation: slideIn 0.3s ease-out both; }
        @keyframes slideIn { from { opacity: 0; transform: translateX(-10px); } to { opacity: 1; transform: translateX(0); } }

        .inner-toggle { font-size: 10px; font-weight: 900; padding: 6px 12px; border-radius: 10px; border: 2.5px solid #000; background: #E2E8F0; }
        .inner-toggle.active { background: var(--grab-yellow); }

        .tab-btn { padding: 12px; font-size: 11px; font-weight: 800; flex: 1; text-transform: uppercase; }
        .tab-disabled { opacity: 0.5; cursor: not-allowed; filter: grayscale(1); }
    </style>
</head>
<body class="antialiased">

    <nav class="nav-bar sticky top-0 z-50">
        <div class="max-w-5xl mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex items-center gap-4">
                <div class="w-10 h-10 lg:w-12 lg:h-12 bg-black rounded-xl flex items-center justify-center border-2 border-white/20 shadow-lg font-black text-white italic text-xl">G</div>
                <p class="font-black text-lg lg:text-2xl tracking-tighter leading-none uppercase">PITCHPRO <span class="bg-black text-[var(--grab-yellow)] text-[8px] lg:text-[10px] px-2 py-0.5 rounded italic font-bold">ELITE</span></p>
            </div>
            <div class="hidden md:block">
                <p class="text-[10px] font-black opacity-30 uppercase tracking-[0.2em]">Merchant Partner System</p>
            </div>
        </div>
    </nav>

    <main class="max-w-5xl mx-auto px-4 py-6 lg:py-10 space-y-8 flex-grow">
        <div class="flex justify-center">
            <div class="relative bg-black/10 p-1.5 rounded-2xl flex w-full max-w-lg border border-black/5">
                <button class="tab-btn bg-white border-2 border-black rounded-xl shadow-[3px_3px_0px_#000] z-10">Grab Funded</button>
                <button class="tab-btn tab-disabled">Co-Funded (Soon)</button>
            </div>
        </div>

        <div class="glass-card p-6 grid grid-cols-1 md:grid-cols-12 gap-6">
            <div class="md:col-span-5 space-y-4 md:border-r-2 md:pr-6 border-slate-100">
                <label class="label-micro text-emerald-600 font-black">1. Pilih Skema Promo</label>
                <div id="strategyContainer">
                    <div id="activePointer"></div>
                    <div id="buttonWrapper"></div>
                </div>
                
                <div id="tierSection" class="hidden pt-4 border-t-2 border-dashed border-slate-200 space-y-3">
                    <label class="label-micro">Pilih Tier</label>
                    <div id="tierWrapper" class="flex gap-2"></div>
                </div>
            </div>
            <div class="md:col-span-7 bg-slate-50 p-6 rounded-3xl h-full border border-black/5">
                <label class="label-micro mb-4">Benefit Skema Terpilih</label>
                <div id="benefitList" class="grid grid-cols-1 sm:grid-cols-2 gap-4"></div>
                <div class="mt-8 pt-4 border-t-2 border-slate-200">
                    <p id="insightPanel" class="text-[11px] font-bold italic opacity-60 leading-relaxed"></p>
                </div>
            </div>
        </div>

        <div class="glass-card p-6 md:p-8 space-y-8">
            <h2 class="text-lg font-black italic uppercase tracking-tighter border-b-2 pb-2">2. Calculator Harga</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="space-y-4">
                    <div>
                        <label class="label-micro">Harga Offline Basis</label>
                        <div class="input-box flex items-center bg-slate-50">
                            <span class="mr-2 opacity-30 italic">Rp</span>
                            <input type="text" id="mainVal" class="bg-transparent outline-none w-full font-black">
                        </div>
                    </div>
                    <div>
                        <label class="label-micro text-blue-700 font-bold">Subsidi Merchant</label>
                        <div class="input-box flex items-center border-blue-600 bg-blue-50">
                            <span id="subLabel" class="mr-2 text-blue-600 font-black italic">Rp</span>
                            <input type="text" id="subVal" class="bg-transparent outline-none w-full text-blue-800">
                            <div class="flex gap-1">
                                <button onclick="setSubMode('val')" id="sVal" class="inner-toggle active">Rp</button>
                                <button onclick="setSubMode('pct')" id="sPct" class="inner-toggle">%</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-3">
                    <div><label class="label-micro">Total Komisi %</label><input type="number" id="kPct" class="input-box text-emerald-600"></div>
                    <div><label class="label-micro">Diskon %</label><input type="number" id="vDisk" class="input-box border-red-500 text-red-600"></div>
                    <div><label class="label-micro">Max Disc</label><input type="text" id="mDisk" class="input-box"></div>
                    <div><label class="label-micro">Min Order</label><input type="text" id="minO" class="input-box"></div>
                </div>
            </div>
        </div>

        <div class="glass-card p-6 md:p-10 border-b-[14px] border-b-[var(--grab-yellow)]">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8 pb-8 border-b-2">
                <div class="p-6 rounded-3xl border-2 bg-slate-50 flex flex-col justify-center">
                    <div class="flex justify-between items-center mb-1">
                        <label class="label-micro opacity-60">Listing Price App</label>
                        <div class="flex items-center gap-2">
                            <span class="text-[8px] font-black opacity-40">Round up</span>
                            <input type="checkbox" id="roundCheck" checked onchange="hitung()" class="w-4 h-4 accent-emerald-500">
                        </div>
                    </div>
                    <h2 id="resApp" class="text-4xl font-black italic tracking-tighter text-amber-600">Rp 0</h2>
                </div>
                <div class="bg-black p-6 rounded-3xl border-4 border-emerald-500 relative">
                    <div class="absolute top-2 right-2"><span id="pStat" class="text-[7px] font-black px-2 py-0.5 rounded text-white">STATUS</span></div>
                    <label class="label-micro text-white/40">Merchant Net Profit</label>
                    <h2 id="resNet" class="text-5xl font-black italic text-[var(--grab-green)] leading-none">Rp 0</h2>
                    <div class="mt-4 pt-3 border-t border-white/10 space-y-1.5">
                        <div class="flex justify-between text-[9px] font-bold text-white/40 uppercase"><span>Service Fee (Base 20%)</span><span id="resSF" class="text-white/70">Rp 0</span></div>
                        <div class="flex justify-between text-[9px] font-bold text-white/40 uppercase"><span>Marketing Success Fee</span><span id="resMF" class="text-white/70">Rp 0</span></div>
                        <div class="flex justify-between text-[9px] font-bold text-white/40 uppercase"><span>Promo Burden (Grab Funded)</span><span id="resDB" class="text-emerald-400 font-black">Rp 0</span></div>
                    </div>
                </div>
            </div>
            <div class="space-y-3 text-xs font-black uppercase">
                <div class="flex justify-between text-slate-400"><span>Original Listing</span><span id="detL" class="text-black">Rp 0</span></div>
                <div class="flex justify-between text-red-600"><span>Campaign Discount</span><span id="detD" class="font-black">- Rp 0</span></div>
                <div class="pt-6 flex justify-between items-end border-t-2 border-dashed">
                    <span class="font-black text-sm italic text-slate-700">Customer Final Pay</span>
                    <span id="resTP" class="text-3xl font-black text-emerald-600 tracking-tighter">Rp 0</span>
                </div>
            </div>
        </div>
    </main>

    <footer class="py-10 bg-black/5">
        <div class="text-center font-black opacity-30 uppercase tracking-[0.4em] text-[10px]">Â© 2026 PITCHPRO | POWERED BY GRAB</div>
    </footer>

<script>
    let sMode = 'val', sTier = 'hemat';
    const state = { mainVal: "25.000", kPct: 20, vDisk: 0, mDisk: "0", minO: "0", subVal: "0", schema: "normal" };

    const PRESETS = {
        'normal': { 
            name: 'âš–ï¸ Standard Normal', k: 20, v: 0, 
            hint: 'Fokus pada margin keuntungan maksimal tanpa dukungan promo aplikasi.', 
            b: { hemat: ['100% Margin Aman', 'Harga Konsisten', 'Tanpa Sukses Fee'] } 
        },
        'puas-cuan': { 
            name: 'ðŸ”¥ Diskon Puas Cuan', k: 32, v: 30, 
            hint: 'Subsidi harian dari Grab untuk menjaga aliran transaksi tetap stabil setiap saat.', 
            tiers: { hemat: { min: 15000, max: 45000 }, ekstra: { min: 35000, max: 80000 } }, 
            b: { 
                hemat: ['Always On Promo 30%', 'In-App Exposure', 'Grab Funded Discount'], 
                ekstra: ['Always On Promo 30%', 'In-App Exposure', 'Prioritas Search Rank'] 
            } 
        },
        'booster': { 
            name: 'ðŸš€ Diskon Puas Booster', k: 38, v: 35, 
            hint: 'Skema komplit untuk dominasi pasar dengan eksposur maksimal & promo eksklusif.', 
            tiers: { hemat: { min: 15000, max: 55000 }, ekstra: { min: 35000, max: 100000 } }, 
            b: { 
                hemat: ['Flash Sale (Up to 55%)', 'Always On Promo 35%', 'Local & Tactical Promo', 'In-App Exposure'], 
                ekstra: ['Flash Sale (Up to 55%)', 'Always On Promo 35%', 'Local & Tactical Promo', 'Priority Ranking Area'] 
            } 
        }
    };

    const fNum = (n) => n.toString().replace(/\D/g, "").replace(/\B(?=(\d{3})+(?!\d))/g, ".");
    const pNum = (n) => parseFloat(n.toString().replace(/\./g, "")) || 0;

    function renderStrategies() {
        const wrapper = document.getElementById('buttonWrapper');
        wrapper.innerHTML = '';
        Object.keys(PRESETS).forEach(key => {
            const item = document.createElement('div');
            item.className = `strat-item ${state.schema === key ? 'active' : ''}`;
            item.innerHTML = `<button class="strat-btn" onclick="selectScheme('${key}', this)">${PRESETS[key].name}</button>`;
            wrapper.appendChild(item);
            if(state.schema === key) setTimeout(() => movePointer(item), 50);
        });
        applyStrategy(state.schema);
    }

    function selectScheme(key, btn) {
        state.schema = key;
        const items = document.querySelectorAll('.strat-item');
        items.forEach(i => i.classList.remove('active'));
        btn.parentElement.classList.add('active');
        movePointer(btn.parentElement);
        applyStrategy(key);
    }

    function movePointer(el) {
        const pointer = document.getElementById('activePointer');
        pointer.style.height = el.offsetHeight + 'px';
        pointer.style.top = el.offsetTop + 'px';
    }

    function applyStrategy(key) {
        const conf = PRESETS[key];
        const ts = document.getElementById('tierSection'), tw = document.getElementById('tierWrapper');

        if (conf.tiers) {
            ts.classList.remove('hidden');
            tw.innerHTML = `<button onclick="setTier('hemat')" class="tier-btn ${sTier==='hemat'?'active':''}">HEMAAT</button><button onclick="setTier('ekstra')" class="tier-btn ${sTier==='ekstra'?'active':''}">EKSTRA</button>`;
            const t = conf.tiers[sTier];
            state.kPct = conf.k; state.vDisk = conf.v; state.minO = fNum(t.min); state.mDisk = fNum(t.max);
        } else {
            ts.classList.add('hidden');
            state.kPct = conf.k; state.vDisk = conf.v; state.minO = "0"; state.mDisk = "0";
        }
        renderBenefits(key);
        document.getElementById('insightPanel').innerText = conf.hint;
        updateUI();
    }

    function setTier(t) { sTier = t; applyStrategy(state.schema); }

    function renderBenefits(key) {
        const container = document.getElementById('benefitList');
        container.innerHTML = '';
        const list = PRESETS[key].tiers ? PRESETS[key].b[sTier] : PRESETS[key].b.hemat;
        list.forEach((item, i) => {
            const el = document.createElement('div');
            el.className = 'benefit-item';
            el.style.animationDelay = `${i * 0.1}s`;
            el.innerHTML = `<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"></path></svg> <span>${item}</span>`;
            container.appendChild(el);
        });
    }

    function updateUI() {
        document.getElementById('mainVal').value = state.mainVal;
        document.getElementById('kPct').value = state.kPct;
        document.getElementById('vDisk').value = state.vDisk;
        document.getElementById('mDisk').value = state.mDisk;
        document.getElementById('minO').value = state.minO;
        document.getElementById('subVal').value = state.subVal;
        hitung();
    }

    function hitung() {
        const off = pNum(state.mainVal), comm = pNum(state.kPct), adj = sMode === 'val' ? pNum(state.subVal) : (off * pNum(state.subVal)/100);
        let list = (off - adj) / (1 - (comm/100));
        if (document.getElementById('roundCheck').checked) list = Math.ceil(list/100)*100;

        const sf = list * 0.20, mf = list * (Math.max(0, comm-20)/100);
        const disc = (list >= pNum(state.minO)) ? Math.min(list * pNum(state.vDisk)/100, pNum(state.mDisk)) : 0;

        document.getElementById('resApp').innerText = "Rp " + fNum(Math.round(list));
        document.getElementById('resNet').innerText = "Rp " + fNum(Math.round(list - sf - mf));
        document.getElementById('resTP').innerText = "Rp " + fNum(Math.round(list - disc));
        document.getElementById('resSF').innerText = "- Rp " + fNum(Math.round(sf));
        document.getElementById('resMF').innerText = "- Rp " + fNum(Math.round(mf));
        document.getElementById('detL').innerText = "Rp " + fNum(Math.round(list));
        document.getElementById('detD').innerText = "- Rp " + fNum(Math.round(disc));

        const ok = (list >= pNum(state.minO) && pNum(state.minO) > 0) || (pNum(state.vDisk) > 0 && pNum(state.minO) == 0);
        const ps = document.getElementById('pStat');
        ps.innerText = ok ? 'PROMO ACTIVE' : 'NO PROMO';
        ps.className = `text-[7px] font-black px-2 py-0.5 rounded ${ok ? 'bg-emerald-500' : 'bg-red-600'} text-white tracking-widest`;
    }

    ['mainVal','kPct','vDisk','mDisk','minO','subVal'].forEach(id => {
        document.getElementById(id).addEventListener('input', (e) => {
            if(['mainVal','subVal','mDisk','minO'].includes(id)) e.target.value = fNum(e.target.value);
            state[id] = e.target.value;
            hitung();
        });
    });

    function setSubMode(m) { 
        sMode = m; 
        document.getElementById('sVal').classList.toggle('active', m==='val');
        document.getElementById('sPct').classList.toggle('active', m==='pct');
        document.getElementById('subLabel').innerText = m==='val'?'Rp':'%';
        hitung(); 
    }

    window.onload = renderStrategies;
</script>
</body>
</html>
